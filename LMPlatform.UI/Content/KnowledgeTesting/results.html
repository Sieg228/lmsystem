<h3 data-ng-show="!groups || groups.length == 0">К предмету не подсоединено ни одной группы</h3>
<tabset>
    <tab heading="Тесты для самоконтроля и ЭУМК">

        <table>
            <tbody>
                <tr>
                    <td style="padding-right:15px">
                        <select ng-model="selectedGroup" ng-options="group.Name for group in groups" ng-change="loadResults(selectedGroup.Id)" class="form-control"></select>
                    </td>
                    <td style="float:right">
                        <button class="btn btn-default" ng-click="resultExport()" style="margin-right: 10px;" tooltip="Загрузить документ в Excel">
                            <img src="/Images/ExcelDownload.png" />
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="input-group input-group-sm search-box" style="margin-bottom: 10px; float: right">
            <span>Поиск&nbsp;</span>
            <input data-ng-model="query" type="text" class="form-control" placeholder="Введите имя студента">
        </div>

        <div class="table-responsive" data-ng-show="results.length > 0">
            <table class="table table-hover table-bordered table-striped">
                <thead>
                    <tr>
                        <th>№</th>
                        <th>Студент</th>
                        <th data-ng-repeat="res in results[0].TestPassResults | filter:forSelfStudyFilter">
                            <div tooltip="{{res.TestName}}" tooltip-placement="right" style="width: 50px;">Тест {{results[0].TestPassResults.indexOf(res) + 1}}</div>
                        </th>
                    </tr>
                </thead>
                <tr data-ng-repeat="result in results | filter:query">
                    <td width="10px">{{results.indexOf(result) + 1}}</td>
                    <td width="300px">{{result.StudentName}}</td>
                    <td data-ng-repeat="mark in result.TestPassResults | filter:forSelfStudyFilter">
                        <div>
                            <div data-ng-show="mark.Points != null" tooltip="Тест {{mark.TestName}} пройден на {{mark.Points}}" tooltip-placement="right">{{mark.Points}} ({{mark.Percent}}%)</div>
                            <a data-ng-show="mark.Points == null" tooltip="Тест {{mark.TestName}} не пройден" tooltip-placement="right"><span class="fa fa-warning fa-1x"></span></a>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td></td>
                    <td style="text-align: right;">Средний процент за тест </td>
                    <td data-ng-repeat="res in results[0].TestPassResults | filter:forSelfStudyFilter">
                        <!--  {{calcTotal(results, $index).Point}} -->
                        {{calcTotal(results, $index).Percent}}%
                    </td>
                </tr>
            </table>
        </div>
        <div class="row col-md-12">
            <div id="chartBarAverage" class="jqplot-target"></div>
        </div>
    </tab>
    <tab heading="Тесты для контроля знаний">

        <table>
            <tbody>
                <tr>
                    <td style="padding-right:15px">
                        <select ng-model="selectedGroup" ng-options="group.Name for group in groups" ng-change="loadResults(selectedGroup.Id)" class="form-control"></select>
                    </td>
                    <td style="float:right">
                        <button class="btn btn-default" ng-click="resultExport()" style="margin-right: 10px;" tooltip="Загрузить документ в Excel">
                            <img src="/Images/ExcelDownload.png" />
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="input-group input-group-sm search-box" style="margin-bottom: 10px; float: right">
            <span>Поиск&nbsp;</span>
            <input data-ng-model="query" type="text" class="form-control" placeholder="Введите имя студента">
        </div>

        <div class="table-responsive" data-ng-show="results.length > 0">
            <table class="table table-hover table-bordered table-striped">
                <thead>
                    <tr>
                        <th>№</th>
                        <th>Студент</th>
                        <th data-ng-repeat="res in results[0].TestPassResults | filter:!forSelfStudyFilter">
                            <div tooltip="{{res.TestName}}" tooltip-placement="right" style="width: 50px;">Тест {{results[0].TestPassResults.indexOf(res) + 1}}</div>
                        </th>
                        <th>Средняя оценка</th>
                    </tr>
                </thead>
                <tr data-ng-repeat="result in results | filter:query">
                    <td width="10px">{{results.indexOf(result) + 1}}</td>
                    <td width="300px">{{result.StudentName}}</td>
                    <td data-ng-repeat="mark in result.TestPassResults | filter:!forSelfStudyFilter">
                        <div>
                            <div data-ng-show="mark.Points != null" tooltip="Тест {{mark.TestName}} пройден на {{mark.Points}}" tooltip-placement="right">{{mark.Points}} ({{mark.Percent}}%)</div>
                            <a data-ng-show="mark.Points == null" tooltip="Тест {{mark.TestName}} не пройден" tooltip-placement="right"><span class="fa fa-warning fa-1x"></span></a>
                        </div>
                    </td>
                    <td>{{calcOverage(result)}}</td>
                </tr>
                <tr>
                    <td></td>
                    <td style="text-align: right;">Средний процент за тест </td>
                    <td data-ng-repeat="res in results[0].TestPassResults | filter:!forSelfStudyFilter">
                        <!--  {{calcTotal(results, $index).Point}} -->
                        {{calcTotal(results, $index).Percent}}%
                    </td>
                    <td></td>
                </tr>
            </table>
        </div>
        <div class="row col-md-12">
            <div id="chartBarAverage" class="jqplot-target"></div>
        </div>
    </tab>
</tabset>


<script>
    $("#headerMainPage").find("small").text("Результаты тестов");
</script>
